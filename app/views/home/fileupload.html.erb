
   <%= form_for @upload, url: home_filecreate_path, html: { multipart: true } do |f| %>

      <%= f.label "복사대" %>
      <%= f.select(:printer, ["K","J","D"], {}, {:id => "printerop"})%>
      <br>

      <%= f.label "픽업날짜" %>
      <%= f.select(:pkupdate, ["오늘","내일"],{}, {:id => "pkupdateop"})%>
      <br>

      <%= f.label "픽업시간" %>
      <%= f.select(:pkuptime, ["10:15~10:30","11:45~12:00", "13:15~13:30", "14:45~15:00","16:15~16:30"],{}, {:id => "pkuptimeop"})%>
      <br>

      <%= f.label "인쇄페이지" %>
      <%= f.text_field :pagenum, :id => "pagenumop" %>
      <br>

      <%= f.label "가로/세로" %>
      <%= f.select(:landscape, ["가로","세로"],{}, {:id => "landscapeop"})%>
      <br>

      <%= f.label "양면/단면" %>
      <%= f.select(:doublepg, ["양면","단면"],{}, {:id => "doublepgop"})%>
      <br>

      <%= f.label "분할" %>
      <%= f.select(:split, ["2","4","6","8"],{}, {:id => "splitop"})%>
      <br>

      <%= f.label "흑백/컬러" %>
      <%= f.select(:color, ["흑백","컬러"],{}, {:id => "colorop"})%>
      <br>

      <%= f.label "첨부파일" %>
      <%= f.file_field :attachment, accept: 'application/pdf, application/vnd.openxmlformats-officedocument.presentationml.presentation, application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/haansofthwp', :id => "attachmentop"  %>
      <br>
<!--       <button type="button"> 작성 완료 </button>
 -->      <%#= f.submit "작성완료" %>

   <% end %>


<!-- Trigger/Open The Modal -->
        <button id="mybtn">작성 완료</button>

        <!-- The Modal -->
        <div id="mymodal" class="modal">

          <!-- Modal content -->
          <div class="modal-content">
            <span class="close">&times;</span>
            <div id ="printerchk"></div>
            <button onclick="$('form').submit()">확인 완료!</button>
          </div>

        </div>

        <script type="text/javascript">
              
                          // Get the modal
            var modal = document.getElementById('mymodal');

            // Get the button that opens the modal
            var btn = document.getElementById("mybtn");

            // Get the <span> element that closes the modal
            var span = document.getElementsByClassName("close")[0];


            // When the user clicks the button, open the modal 
            btn.onclick = function() {
                  var errormsg = empty_check();
                  if ( !errormsg ){
                        modal.style.display = "block";
                        print_selected_option();
                  }else{
                        alert(errormsg);
                  }
                
            }

            // When the user clicks on <span> (x), close the modal
            span.onclick = function() {
                modal.style.display = "none";
            }

            // When the user clicks anywhere outside of the modal, close it
            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }

            function empty_check(){ 
                  var val4 = document.getElementById("pagenumop").value;

                  var val9 = document.getElementById("attachmentop").value
                  var msg = "";

                  if (!val4){
                        msg += "인쇄할 페이지 범위를 반드시 입력해주세요!\n"

                  }
                  if (!val9){
                        msg += "인쇄할 문서를 반드시 첨부해주세요!\n"
                  }

                  return msg;
            }

            function print_selected_option(){

                  var sel = document.getElementById("printerchk");

                  var val1 = document.getElementById("printerop").value;
                  var val2 = document.getElementById("pkuptimeop").value;
                  var val3 = document.getElementById("pkupdateop").value;
                  var val4 = document.getElementById("pagenumop").value;
                  var val5 = document.getElementById("landscapeop").value;
                  var val6 = document.getElementById("doublepgop").value;
                  var val7 = document.getElementById("splitop").value;
                  var val8 = document.getElementById("colorop").value;
                  var val9 = document.getElementById("attachmentop").value.substring(12);

                  total = totalPage(val4, val7);

                  sel.innerHTML = 

                  "결제 예정 금액:"+ (50*total) +"원<br><hr><br>"+
                  "파일명:"+val9+"<br>"+
                  "인쇄할 페이지:"+val4+"(총"+total+"장)<br><hr><br>"+
                  val5+"방향 / "+val7+"분할 / "+val6+" / "+val8+"<br><hr><br>"+
                  "수령장소,시간:"+val1+"관 복사대, "+val2+" "+val3+"<br>"+
                  "잔여 포인트:";



            }

            function totalPage(pagenum, split){

                  var count = 0;
                  var pagenum_c = pagenum.split(',');
                  var len = pagenum_c.length;
                  for (var i=0; i<len; i++){

                        if (pagenum_c[i].includes("-")){
                              pagenum_d = pagenum_c[i].split("-");
                              count += (parseInt(pagenum_d[1]) - parseInt(pagenum_d[0]) +1);
                        }
                        else{
                              count+=1;
                        }
                  }
                  if (split.to_i % 2 == 0){
                        count = parseInt(count/split);
                  }else{
                        count = parseInt(count/split) +1;
                  }

                  return count;

            }
        </script>